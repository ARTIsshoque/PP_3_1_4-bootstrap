<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" xmlns:th="http://www.thymeleaf.org" lang="en">

<head>
 <meta charset="UTF-8" />
 <meta name="viewport" content="width=device-width, initial-scale=1.0" />
 <link rel="stylesheet" th:href="@{/css/bootstrap.min.css}">
 <title>User page</title>
</head>

<body style="--bs-body-font-size: 1.25rem">
 <div th:replace="~{fragments/header :: header}"></div>

 <div class="container-fluid">
  <div class="row mt-3">
   <div class="col bg-white px-0">
    <div class="d-flex flex-column">
     <div class="nav flex-column nav-pills" id="v-pills-tab" role="tablist" aria-orientation="vertical">
      <button class="nav-link text-start active" id="v-pills-admin-tab" data-bs-toggle="pill"
              data-bs-target="#v-pills-admin" type="button" role="tab" aria-controls="v-pills-admin"
              aria-selected="true">Admin
      </button>
      <button class="nav-link text-start" id="v-pills-user-tab" data-bs-toggle="pill"
              data-bs-target="#v-pills-user" type="button" role="tab" aria-controls="v-pills-user"
              aria-selected="false">User
      </button>
     </div>
    </div>
   </div>
   <div class="col-10 vh-100 bg-light">
    <div class="tab-content" id="v-pills-tabContent">
     <div class="tab-pane fade show active" id="v-pills-admin" role="tabpanel" aria-labelledby="v-pills-admin-tab">
      <div th:replace="~{this :: admininfo}"></div>
     </div>
     <div class="tab-pane fade" id="v-pills-user" role="tabpanel" aria-labelledby="v-pills-user-tab">
      <div class="m-3">
       <h1 class="ps-3 fw-bold">User information-page</h1>
        <div class="container-fluid m-2">
         <div class="row border bg-light">
          <h4 class="p-3 fw-semibold">About user</h4>
         </div>
         <div class="row border bg-white p-4">
          <table class="table table-borderless table-striped">
           <thead>
            <tr class="border-top">
             <th scope="col">ID</th>
             <th scope="col">First Name</th>
             <th scope="col">Last Name</th>
             <th scope="col">Age</th>
             <th scope="col">Email</th>
             <th scope="col">Role</th>
            </tr>
           </thead>
           <tbody>
            <tr class="border-top bg-light" th:object="${user}">
             <td th:text="*{id}">id</td>
             <td th:text="*{firstName}">first name</td>
             <td th:text="*{lastName}">last name</td>
             <td th:text="*{age}">age</td>
             <td th:text="*{email}">email</td>
             <td>
              <th:block th:each="role : *{getRoles()}">
               <span th:text="${role.getName() + ' '}">role</span>
              </th:block>
             </td>
            </tr>
           </tbody>
          </table>
         </div>
        </div>
       </div>
      </div>
     </div>
    </div>

    <div class="invisible">
     <div th:fragment="admininfo" class="m-3">
      <h1 class="fw-bold">Admin panel</h1>
      <nav class="mt-3">
       <div class="nav nav-tabs" id="nav-tab" role="tablist">
        <button class="nav-link active" id="nav-users-tab" data-bs-toggle="tab"
                data-bs-target="#nav-users" type="button" role="tab" aria-controls="nav-users"
                aria-selected="true">Users table
        </button>
        <button class="nav-link" id="new-user-tab" data-bs-toggle="tab"
                data-bs-target="#newUser" type="button" role="tab" aria-controls="newUser"
                aria-selected="false">New User
        </button>
       </div>
      </nav>
      <div class="tab-content" id="nav-tabContent">
       <div class="tab-pane fade show active" id="nav-users" role="tabpanel" aria-labelledby="nav-users-tab">
        <div class="px-3 pt-3 bg-light">
         <h4 class="fw-semibold">All users</h4>
        </div>
        <div class="pt-3 pb-4 px-3 bg-white">
        <table class="table table-striped bg-white border-top">
         <thead>
          <tr>
           <th scope="col">ID</th>
           <th scope="col">First Name</th>
           <th scope="col">Last Name</th>
           <th scope="col">Age</th>
           <th scope="col">Email</th>
           <th scope="col">Role</th>
           <th scope="col">Edit</th>
           <th scope="col">Delete</th>
          </tr>
         </thead>
        <tbody>
         <tr th:each="user: ${users}" class="py-2">
          <td th:text="${user.getId()}">id</td>
          <td th:text="${user.getFirstName()}">first name</td>
          <td th:text="${user.getLastName()}">last name</td>
          <td th:text="${user.getAge()}">age</td>
          <td th:text="${user.getEmail()}">email</td>
          <td>
           <span th:each="role : ${user.getRoles()}" th:text="${role.getName() + ' '}">role</span>
          </td>
          <td>
           <button type="button" class="btn btn-info text-white" data-bs-toggle="modal" th:attr="data-bs-target='#editModal'+${user.id}">
                  Edit
           </button>
          </td>
          <td>
           <button type="button" class="btn btn-danger" data-bs-toggle="modal" th:attr="data-bs-target='#deleteModal'+${user.id}">
                  Delete
           </button>
          </td>
         </tr>
        </tbody>
       </table>
       </div>
      </div>

      <div class="tab-pane fade px-4" id="newUser" role="tabpanel" aria-labelledby="nav-newUser-tab">
       <div class="p-2 fw-semibold">
        <h5>Add new user</h5>
       </div>
       <div class="row justify-content-center align-items-center bg-white">
        <div class="col-4 mb-4">
         <form class="text-center" th:method="POST" th:action="@{/admin/add}" th:object="${newUser}">
          <div class="form-group fw-bold">
           <div class="form-group m-3">
            <div class="form-group m-3">
             <label for="FirstNameNew" class="col-form-label">First name</label>
             <input type="text" class="form-control" id="FirstNameNew" name="firstName" value="" required />
            </div>
            <div class="form-group m-3">
              <label for="lastNameNew" class="col-form-label">Last name</label>
              <input type="text" class="form-control" id="lastNameNew" name="lastName" value="" required />
            </div>
            <div class="form-group m-3">
             <label for="ageNew" class="col-form-label">Age</label>
             <input type="number" class="form-control" id="ageNew" name="age" value="" required />
            </div>
            <div class="form-group m-3">
             <label for="emailNew" class="col-form-label">Email</label>
             <input type="email" class="form-control" id="emailNew" name="email" value="" required />
            </div>
            <div class="form-group m-3">
             <label for="passwordNew" class="col-form-label">Password</label>
             <input type="password" class="form-control" id="passwordNew" name="password" value="" required />
            </div>
            <div class="form-group m-3">
             <label for="rolesAdd">Role</label>
             <select class="form-select w-100" multiple size="2" id="rolesAdd" name="roles">
              <option th:each="role : ${allRoles}" th:value="${role.getId()}" th:text="${role.getName()}"
                      th:field="*{roles}">role</option>
             </select>
            </div>
           </div>
          </div>
          <button type="submit" class="btn btn-success btn-lg">Add new user</button>
         </form>
        </div>
       </div>
      </div>
     </div>
    </div>
   </div>
  </div>
 </div>


 <div th:each="userf:${users}">
  <div class="deleteForm">
   <div class="modal fade" th:attr="id='deleteModal'+${userf.id}" aria-hidden="true" role="dialog" aria-labelledby="deleteModal">
    <div class="modal-dialog">
     <div class="modal-content">
      <div class="modal-header">
       <h5 class="modal-title fw-semibold">Delete user</h5>
       <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
      </div>
      <div class="modal-body fw-bold">
       <div style="text-align: center">
        <div class="row align-items-center">
         <form class="text-center" th:action="@{/admin/delete}" method="POST" id="deleteFormBody">
          <div class="form-group font-weight-bold">
           <div class="form-group m-1 w-50 d-inline-block">
            <label for="idDelete" class="col-form-label">ID</label>
            <input type="hidden" name="id" th:value="${userf.getId()}">
            <input type="text" class="form-control" id="idDelete" name="idDelete" th:value="${userf.getId()}" disabled />
           </div>
           <div class="form-group m-1 w-50 d-inline-block">
            <label for="firstNameDelete" class="col-form-label">First name</label>
            <input type="text" class="form-control" id="firstNameDelete" name="firstName" th:value="${userf.getFirstName()}" disabled />
           </div>
           <div class="form-group m-1 w-50 d-inline-block">
            <label for="lastNameDelete" class="col-form-label">Last name</label>
            <input type="text" class="form-control" id="lastNameDelete" name="lastName" th:value="${userf.getLastName()}" disabled />
           </div>
           <div class="form-group m-1 w-50 d-inline-block">
            <label for="ageDelete" class="col-form-label">Age</label>
            <input type="text" class="form-control" id="ageDelete" name="age" th:value="${userf.getAge()}" disabled />
           </div>
           <div class="form-group m-1 w-50 d-inline-block">
            <label for="emailDelete" class="col-form-label">Email</label>
            <input type="text" class="form-control" id="emailDelete" name="email" th:value="${userf.getEmail()}" disabled />
           </div>
           <div class="form-group m-1 w-50 d-inline-block" readonly="readonly">
            <label for="rolesDelete">Role</label>
            <select class="form-select w-100 " size="2" id="rolesDelete" name="userRoles" disabled>
             <option th:each="role: ${userf.getRoles()}" th:text="${role.getName()}">role</option>
            </select>
           </div>
           <div class="modal-footer mt-4">
            <button type="button" class="btn btn-secondary btn-lg" data-bs-dismiss="modal">Close</button>
            <input type="submit" class="btn btn-danger btn-lg" value="Delete" />
           </div>
          </div>
         </form>
        </div>
       </div>
      </div>
     </div>
    </div>
   </div>
  </div>
 </div>

 <div th:each="userf:${users}">
  <div class="editForm">
   <div class="modal fade" th:attr="id='editModal'+${userf.id}" aria-hidden="true" role="dialog" aria-labelledby="editModal">
    <div class="modal-dialog">
     <div class="modal-content">
      <div class="modal-header">
       <h5 class="modal-title">Edit user</h5>
       <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
      </div>
      <div class="modal-body fw-bold">
       <div>
        <div class="row justify-content-center align-items-center">
         <form class="text-center" th:action="@{/admin/update}" th:method="POST" th:object="${newUser}" id="editFormBody">
          <div class="form-group font-weight-bold">
           <div class="form-group m-1 w-50 d-inline-block">
            <label for="idEdit" class="col-form-label">ID</label>
            <input type="hidden" name="id" th:value="${userf.id}">
            <input type="text" class="form-control" id="idEdit" name="userId" th:value="${userf.id}" disabled />
           </div>
           <div class="form-group m-1 w-50 d-inline-block">
            <label for="firstNameEdit">First name</label>
            <input type="text" class="form-control" id="firstNameEdit" name="firstName" th:value="${userf.firstName}" />
           </div>
           <div class="form-group m-1 w-50 d-inline-block">
            <label for="lastNameEdit" class="col-form-label">Last name</label>
            <input type="text" class="form-control" id="lastNameEdit" name="lastName" th:value="${userf.lastName}" />
           </div>
           <div class="form-group m-1 w-50 d-inline-block">
            <label for="ageEdit" class="col-form-label">Age</label>
            <input type="number" class="form-control" id="ageEdit" name="age" th:value="${userf.age}" />
           </div>
           <div class="form-group m-1 w-50 d-inline-block">
            <label for="emailEdit" class="col-form-label">Email</label>
            <input type="email" class="form-control" id="emailEdit" name="email" th:value="${userf.email}" />
           </div>
           <div class="form-group m-1 w-50 d-inline-block">
            <label for="passwordEdit" class="col-form-label">Password</label>
            <input type="password" class="form-control" id="passwordEdit" name="password" value="password" />
           </div>
           <div class="form-group m-1 w-50 d-inline-block">
            <label for="rolesEdit">Role</label>
            <select class="form-select w-100" multiple size="2" id="rolesEdit" name="roles">
             <option th:each="role: ${allRoles}" th:text="${role.getName()}" th:value="${role.getId()}" th:field="*{roles}" selected>role</option>
            </select>
           </div>
           <div class="modal-footer mt-4">
            <button type="button" class="btn btn-secondary btn-lg" data-bs-dismiss="modal">Close</button>
            <input type="submit" class="btn btn-primary btn-lg" value="Edit" />
           </div>
          </div>
         </form>
        </div>
       </div>
      </div>
     </div>
    </div>
   </div>
  </div>
 </div>

 <script th:src="@{/js/bootstrap.bundle.min.js}"></script>
</body>
</html>